<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#1a1a2e">
    <title>Volleyball Referee</title>
    <link rel="stylesheet" href="styles.css">
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-RBPL9H3D0Y"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-RBPL9H3D0Y');
    </script>
</head>
<body>
    <div class="container">
        <h1>Volleyball Referee</h1>

        <div id="setup" class="setup-panel">
            <h2>Match Setup</h2>
            <div class="team-setup-container">
                <div class="team-setup team1-setup">
                    <h3>Team 1</h3>
                    <div class="team-input">
                        <label for="team1Name">Team Name:</label>
                        <input type="text" id="team1Name" value="Team A">
                    </div>
                    <div class="team-input">
                        <label for="team1Players">Jersey Numbers (comma separated):</label>
                        <input type="text" id="team1Players" placeholder="1, 2, 3, 4, 5, 6">
                    </div>
                    <div class="team-input-row">
                        <div class="team-input">
                            <label for="team1Captain">Captain #:</label>
                            <input type="number" id="team1Captain" placeholder="Cap">
                        </div>
                        <div class="team-input">
                            <label for="team1Libero">Libero #:</label>
                            <input type="number" id="team1Libero" placeholder="Lib">
                        </div>
                    </div>
                </div>
                <div class="team-setup team2-setup">
                    <h3>Team 2</h3>
                    <div class="team-input">
                        <label for="team2Name">Team Name:</label>
                        <input type="text" id="team2Name" value="Team B">
                    </div>
                    <div class="team-input">
                        <label for="team2Players">Jersey Numbers (comma separated):</label>
                        <input type="text" id="team2Players" placeholder="1, 2, 3, 4, 5, 6">
                    </div>
                    <div class="team-input-row">
                        <div class="team-input">
                            <label for="team2Captain">Captain #:</label>
                            <input type="number" id="team2Captain" placeholder="Cap">
                        </div>
                        <div class="team-input">
                            <label for="team2Libero">Libero #:</label>
                            <input type="number" id="team2Libero" placeholder="Lib">
                        </div>
                    </div>
                </div>
            </div>
            <div class="match-type">
                <label>Match Type:</label>
                <div class="radio-group">
                    <label>
                        <input type="radio" name="matchType" value="3" checked> Best of 3 Sets
                    </label>
                    <label>
                        <input type="radio" name="matchType" value="5"> Best of 5 Sets
                    </label>
                </div>
            </div>
            <div id="setupError" class="setup-error hidden"></div>
            <button id="startMatch" class="btn btn-primary">Start Match</button>
        </div>

        <div id="rotationSetup" class="rotation-setup hidden">
            <h2>Set Starting Rotations</h2>
            <div id="rotationSetupSetScore" class="rotation-setup-score hidden"></div>
            <p class="rotation-setup-hint">Click on each position to assign a player. Libero is not available for starting rotation.</p>
            <div class="rotation-setup-container">
                <div class="rotation-setup-team">
                    <h3 id="rotationTeam1Name">Team A</h3>
                    <div class="rotation-setup-grid" id="rotationSetup1">
                        <div class="rotation-setup-row">
                            <span class="rotation-setup-pos" data-team="1" data-pos="4">4</span>
                            <span class="rotation-setup-pos" data-team="1" data-pos="3">3</span>
                            <span class="rotation-setup-pos" data-team="1" data-pos="2">2</span>
                        </div>
                        <div class="rotation-setup-row">
                            <span class="rotation-setup-pos" data-team="1" data-pos="5">5</span>
                            <span class="rotation-setup-pos" data-team="1" data-pos="6">6</span>
                            <span class="rotation-setup-pos" data-team="1" data-pos="1">1</span>
                        </div>
                    </div>
                    <div class="available-players" id="availablePlayers1"></div>
                </div>
                <div class="rotation-setup-team">
                    <h3 id="rotationTeam2Name">Team B</h3>
                    <div class="rotation-setup-grid" id="rotationSetup2">
                        <div class="rotation-setup-row">
                            <span class="rotation-setup-pos" data-team="2" data-pos="4">4</span>
                            <span class="rotation-setup-pos" data-team="2" data-pos="3">3</span>
                            <span class="rotation-setup-pos" data-team="2" data-pos="2">2</span>
                        </div>
                        <div class="rotation-setup-row">
                            <span class="rotation-setup-pos" data-team="2" data-pos="5">5</span>
                            <span class="rotation-setup-pos" data-team="2" data-pos="6">6</span>
                            <span class="rotation-setup-pos" data-team="2" data-pos="1">1</span>
                        </div>
                    </div>
                    <div class="available-players" id="availablePlayers2"></div>
                </div>
            </div>
            <div id="rotationSetupError" class="setup-error hidden"></div>
            <button id="confirmRotation" class="btn btn-primary">Start Match</button>
        </div>

        <div id="scoreboard" class="scoreboard hidden">
            <div class="match-info">
                <span id="matchTypeDisplay"></span>
                <span id="currentSetDisplay"></span>
            </div>

            
            <div class="current-set">
                <div class="team team1">
                    <div class="team-name" id="team1Display">Team A</div>
                    <div class="timeout-container">
                        <button class="timeout-btn" id="timeout1" data-team="1" title="Call timeout">
                            <img src="icons/timer.png" alt="Timeout" class="timeout-icon">
                        </button>
                        <div class="timeout-dots" id="timeoutDots1">
                            <span class="timeout-dot active"></span>
                            <span class="timeout-dot active"></span>
                        </div>
                    </div>
                    <div class="rotation-grid" id="rotation1">
                        <div class="rotation-row front-row">
                            <div class="rotation-pos" data-team="1" data-pos="4"><span class="player-num"></span><span class="sub-indicator"></span></div>
                            <div class="rotation-pos" data-team="1" data-pos="3"><span class="player-num"></span><span class="sub-indicator"></span></div>
                            <div class="rotation-pos" data-team="1" data-pos="2"><span class="player-num"></span><span class="sub-indicator"></span></div>
                        </div>
                        <div class="rotation-row back-row">
                            <div class="rotation-pos" data-team="1" data-pos="5"><span class="player-num"></span><span class="sub-indicator"></span></div>
                            <div class="rotation-pos" data-team="1" data-pos="6"><span class="player-num"></span><span class="sub-indicator"></span></div>
                            <div class="rotation-pos" data-team="1" data-pos="1"><span class="player-num"></span><span class="sub-indicator"></span></div>
                        </div>
                    </div>
                    <div class="score" id="team1Score">0</div>
                    <button class="btn btn-score" data-team="1">+1 Point</button>
                </div>

                <div class="vs-container">
                    <div class="undo-btn" id="undoPoint" title="Undo last point">
                        <img src="icons/undo.png" alt="Undo" class="undo-icon">
                    </div>
                    <div class="swap-teams" id="swapTeams" title="Swap teams">
                        <img src="icons/swap.png" alt="Swap teams" class="swap-icon">
                    </div>
                    <div class="serve-indicator" id="serveIndicator" title="Click to switch service">
                        <img src="icons/volleyball.png" alt="Service" class="serve-ball" id="serveBall">
                    </div>
                    <div class="vs">VS</div>
                    <div class="sets-score-center" id="setsScoreCenter"></div>
                </div>

                <div class="team team2">
                    <div class="team-name" id="team2Display">Team B</div>
                    <div class="timeout-container">
                        <button class="timeout-btn" id="timeout2" data-team="2" title="Call timeout">
                            <img src="icons/timer.png" alt="Timeout" class="timeout-icon">
                        </button>
                        <div class="timeout-dots" id="timeoutDots2">
                            <span class="timeout-dot active"></span>
                            <span class="timeout-dot active"></span>
                        </div>
                    </div>
                    <div class="rotation-grid" id="rotation2">
                        <div class="rotation-row front-row">
                            <div class="rotation-pos" data-team="2" data-pos="4"><span class="player-num"></span><span class="sub-indicator"></span></div>
                            <div class="rotation-pos" data-team="2" data-pos="3"><span class="player-num"></span><span class="sub-indicator"></span></div>
                            <div class="rotation-pos" data-team="2" data-pos="2"><span class="player-num"></span><span class="sub-indicator"></span></div>
                        </div>
                        <div class="rotation-row back-row">
                            <div class="rotation-pos" data-team="2" data-pos="5"><span class="player-num"></span><span class="sub-indicator"></span></div>
                            <div class="rotation-pos" data-team="2" data-pos="6"><span class="player-num"></span><span class="sub-indicator"></span></div>
                            <div class="rotation-pos" data-team="2" data-pos="1"><span class="player-num"></span><span class="sub-indicator"></span></div>
                        </div>
                    </div>
                    <div class="score" id="team2Score">0</div>
                    <button class="btn btn-score" data-team="2">+1 Point</button>
                </div>
            </div>

            <div class="point-timeline">
                <h3>Set <span id="timelineSetNumber">1</span> Scoring</h3>
                <div class="timeline-container">
                    <div class="timeline-team">
                        <span class="timeline-label" id="timelineTeam1Label"></span>
                        <div class="timeline-row" id="team1Timeline"></div>
                    </div>
                    <div class="timeline-team">
                        <span class="timeline-label" id="timelineTeam2Label"></span>
                        <div class="timeline-row" id="team2Timeline"></div>
                    </div>
                </div>
            </div>

            
            <div class="controls">
                <button id="newMatch" class="btn btn-danger">New Match</button>
            </div>
        </div>

        <div id="matchResult" class="match-result hidden">
            <h2>Match Complete!</h2>
            <div id="winner" class="winner"></div>
            <div id="finalScore" class="final-score"></div>
            <button id="playAgain" class="btn btn-primary">Play Again</button>
        </div>
    </div>

    <div id="subModal" class="modal hidden">
        <div class="modal-content sub-modal-content">
            <h2>Substitute Player</h2>
            <p id="subCurrentPlayer"></p>
            <div class="sub-options" id="subOptions"></div>
            <button class="btn btn-secondary" id="cancelSub">Cancel</button>
        </div>
    </div>

    <div id="timeoutModal" class="modal hidden">
        <div class="modal-content">
            <h2 id="timeoutTeamName">Team Timeout</h2>
            <div class="timer-display">
                <svg class="timer-ring" viewBox="0 0 100 100">
                    <circle class="timer-ring-bg" cx="50" cy="50" r="45"/>
                    <circle class="timer-ring-progress" id="timerProgress" cx="50" cy="50" r="45"/>
                </svg>
                <span class="timer-text" id="timerText">30</span>
            </div>
            <button class="btn btn-primary" id="continueEarly">Continue</button>
        </div>
    </div>

    <footer class="credits">v2.11 | Created by Menon Pranto</footer>

    <script src="app.js"></script>
</body>
</html>
